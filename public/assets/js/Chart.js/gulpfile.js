var gulp=require("gulp"),concat=require("gulp-concat"),uglify=require("gulp-uglify"),util=require("gulp-util"),jshint=require("gulp-jshint"),size=require("gulp-size"),connect=require("gulp-connect"),replace=require("gulp-replace"),htmlv=require("gulp-html-validator"),inquirer=require("inquirer"),semver=require("semver"),exec=require("child_process").exec,fs=require("fs"),package=require("./package.json"),bower=require("./bower.json"),srcDir="./src/";gulp.task("build",function(){function e(e){return srcDir+"Chart."+e+".js"}var r=[e("Core")],i=!!util.env.types,s=i?"custom":".";return i?util.env.types.split(",").forEach(function(i){return r.push(e(i))}):r.push(srcDir+"*"),gulp.src(r).pipe(concat("Chart.js")).pipe(replace("{{ version }}",package.version)).pipe(gulp.dest(s)).pipe(uglify({preserveComments:"some"})).pipe(concat("Chart.min.js")).pipe(gulp.dest(s))}),gulp.task("bump",function(e){util.log("Current version:",util.colors.cyan(package.version));var r=["major","premajor","minor","preminor","patch","prepatch","prerelease"].map(function(e){return e+" (v"+semver.inc(package.version,e)+")"});inquirer.prompt({type:"list",name:"version",message:"What version update would you like?",choices:r},function(r){var i=r.version.split(" ")[0],s=semver.inc(package.version,i);package.version=s,bower.version=s,fs.writeFileSync("package.json",JSON.stringify(package,null,2)),fs.writeFileSync("bower.json",JSON.stringify(bower,null,2)),e()})}),gulp.task("release",["build"],function(){exec("git tag -a v"+package.version)}),gulp.task("jshint",function(){return gulp.src(srcDir+"*.js").pipe(jshint()).pipe(jshint.reporter("default"))}),gulp.task("valid",function(){return gulp.src("samples/*.html").pipe(htmlv())}),gulp.task("library-size",function(){return gulp.src("Chart.min.js").pipe(size({gzip:!0}))}),gulp.task("module-sizes",function(){return gulp.src(srcDir+"*.js").pipe(uglify({preserveComments:"some"})).pipe(size({showFiles:!0,gzip:!0}))}),gulp.task("watch",function(){gulp.watch("./src/*",["build"])}),gulp.task("test",["jshint","valid"]),gulp.task("size",["library-size","module-sizes"]),gulp.task("default",["build","watch"]),gulp.task("server",function(){connect.server({port:8e3})}),gulp.task("_open",function(){exec("open http://localhost:8000"),exec("subl .")}),gulp.task("dev",["server","default"]);